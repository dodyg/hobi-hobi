@model HobiHobi.Core.Feeds.FeedsRiver
@{
    ViewBag.Title = "Tabbed Rivers";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<a href="https://github.com/dodyg/hobi-hobi"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png" alt="Fork me on GitHub"></a>
<br />
<br />

<div class="tabbable">
    <ul class="nav nav-tabs">
        <li class="active"><a href="#apple" data-id="apple" data-toggle="tab" data-origin-feed="static.scripting.com/houston/rivers/apple/apple.json">apple</a></li>
        <li><a href="#dave" data-id="dave" data-toggle="tab" data-origin-feed="static.scripting.com/houston/rivers/dave/dave.json">dave</a></li>
        <li><a href="#nyt" data-id="nyt" data-toggle="tab" data-origin-feed="static.scripting.com/houston/rivers/nyt/nyt.json">nyt</a></li>
    </ul>
</div>

<h1 id="river_title">Apple River</h1>
<br />

<div style="font-size:16px;">
Source : <a href="#" id="river_origin_feed"></a>
</div>


<div id="river">
    @ViewBag.Output
</div>
<br /><br />

<div id="loading_div">
    <img src="/images/ajax_spinner.gif" alt="wait" />
</div>

@section JsInline{
    <script type="text/ecmascript">
        $(function () {
            $('#loading_div').hide()  // hide it initially
                .ajaxStart(function () {
                    $(this).show();
                })
                .ajaxStop(function () {
                $(this).hide();});
            
            load('apple', true, 'static.scripting.com/houston/rivers/apple/apple.json');

            $('a[data-toggle="tab"]').on('shown', function (e) {
                var feedName = $(e.target).data('id'); 
                var feedOrigin = $(e.target).data('origin-feed');
                load(feedName, false, feedOrigin);
            })
        });

        function load(feedName, isInitial, feedOrigin) {
            $('#river_title').html(feedName + " river");
            if (feedOrigin !== undefined) {
                $('#river_origin_feed')
                    .attr('href', 'http://' + feedOrigin)
                    .html(feedOrigin);
            }
            $.get('/home/feed?feedname=' + feedName, function (data) {
                $('#river').html(data);
                if (isInitial)
                    arrange();
                else {
                    $('#river').isotope('destroy');
                    arrange()
                }
            });
        }

        function arrange() {
            $('#river').isotope({
                itemSelector: ".feed_item",
                layoutMode: 'masonry',
                getSortData: {
                    feed_id: function ($elem) {
                        return parseInt($elem.data('id'));
                    }
                },
                sortBy: 'feed_id',
                sortAscending: false
            });
        }
    </script>
}

@section CssInline{
    <style type="text/css">
        body {
            background-image: url('/images/retina_wood.png');
            background-repeat: repeat;
        }
        
        .feed_item {
            width: 300px;
            border:1px solid grey;
            padding:5px;
            margin-right:5px;
            margin-top:5px;
            margin-bottom:5px;
            background-color:#f7f1f1;
        }

            .feed_item h2 {
                font-size: 16px;
                line-height:18px;
            }

            .feed_item h3 {
                font-size: 14px;
                line-height: 16px;
            }

        .feed_date, .last_updated, .feed_origin_website, .feed_origin_website a:link {
            font-size:10px;
        }
       
        
        #loading_div {
            height: 400px;
            position: relative;
        }
            #loading_div img{
                position: absolute;
                left: 50%;
                top: 50%;
                margin-left: -32px; /* -1 * image width / 2 */
                margin-top: -32px;  /* -1 * image height / 2 */
                display: block;     
            }
    </style>
}